import{t as e}from"./password-input-B8gUCWPK.js";import{$ as t,A as n,C as r,D as i,F as a,G as o,I as s,J as c,K as l,O as u,P as d,Q as f,S as p,T as m,U as h,X as g,Z as _,_ as v,c as y,h as b,k as x,l as S,p as C,q as w,w as T}from"./index-CMrTxhGt.js";var E=t(f()),D=t(h()),O=()=>{let t=c(),f=g(),{t:h}=o(),y=_(d),[w,O]=(0,E.useState)(``),[k,A]=(0,E.useState)(``),[j,M]=(0,E.useState)(``),[N,P]=(0,E.useState)(``),{register:F,handleSubmit:I,setError:L,clearErrors:R,formState:{errors:z}}=v({resolver:b(C),mode:`onChange`}),B=(0,E.useCallback)(i(async e=>{if(!(!e||e.length<3))try{await a.validateUsername(e),R(`username`)}catch(e){L(`username`,{type:`manual`,message:e.response?.data?.message||h(`username_existed`)})}},700),[]),V=(0,E.useCallback)(i(async e=>{if(!e){O(``);return}if(!x(e)){O(h(`email_invalid`)),R(`email`);return}O(``);try{await a.validateEmail(e),R(`email`)}catch(e){L(`email`,{type:`manual`,message:e.response?.data?.message||h(`email_existed`)})}},1200),[]),H=(0,E.useCallback)(i(e=>{if(!e){A(``);return}n(e)?A(``):(A(h(`password_at_least`)),R(`password`))},700),[]),U=(0,E.useCallback)(i(e=>{if(!e){M(``);return}u(N,e)?M(``):(M(h(`confirmpassword_not_match`)),R(`password_confirmation`))},700),[N]);return(0,E.useEffect)(()=>()=>{f(m())},[f]),(0,D.jsxs)(`form`,{onSubmit:I(async e=>{f(r());try{let n=await a.register(e);n.access_token&&localStorage.setItem(`access_token`,n.access_token),n.refresh_token&&localStorage.setItem(`refresh_token`,n.refresh_token),n.user&&localStorage.setItem(`user`,n.user),f(T(n)),l.success(h(`signup_success`),{description:h(`we_have_sent_verify_email`),duration:3e3}),setTimeout(()=>{t(`/auth/login`)},500)}catch(e){let t=e.response?.data||{message:e.message};f(p(t));let n=t.message||h(`signup_fail`);t.errors&&Object.keys(t.errors).forEach(e=>{L(e,{type:`manual`,message:t.errors[e][0]})}),l.error(h(`signup_fail`),{description:n})}}),className:`w-full flex flex-col gap-2`,children:[(0,D.jsx)(S,{type:`text`,placeholder:h(`username`),...F(`username`),onChange:e=>{F(`username`).onChange(e),B(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.username?`border-destructive`:``}`,disabled:y}),z.username&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.username.message}),(0,D.jsx)(S,{type:`email`,placeholder:h(`email`),...F(`email`),onChange:e=>{F(`email`).onChange(e),V(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.email||w?`border-destructive`:``}`,disabled:y}),w&&(0,D.jsx)(`p`,{className:`text-destructive`,children:w}),z.email&&!w&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.email.message}),(0,D.jsx)(e,{placeholder:h(`password`),...F(`password`),onChange:e=>{let t=e.target.value;F(`password`).onChange(e),P(t),H(t)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.password||k?`border-destructive`:``}`,disabled:y}),k&&(0,D.jsx)(`p`,{className:`text-destructive`,children:k}),z.password&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.password.message}),(0,D.jsx)(e,{type:`password`,placeholder:h(`confirm_password`),...F(`password_confirmation`),onChange:e=>{F(`password_confirmation`).onChange(e),U(e.target.value)},className:`h-12 bg-threaditembg border-input-border rounded-xl text-normaltext placeholder:text-normaltext-tertiary ${z.password_confirmation||j?`border-destructive`:``}`,disabled:y}),j&&(0,D.jsx)(`p`,{className:`text-destructive`,children:j}),z.password_confirmation&&(0,D.jsx)(`p`,{className:`text-destructive`,children:z.password_confirmation.message}),(0,D.jsx)(s,{type:`submit`,className:`w-full h-12 bg-foreground text-background !hover:bg-systemtext cursor-pointer rounded-2xl`,disabled:y,children:h(y?`siging_up`:`sigup`)})]})};function k(){let{t:e}=o();return(0,D.jsxs)(`div`,{className:`max-w-[370px] min-w-[300px] p-6! mx-auto! flex flex-col gap-2 absolute top-full left-[50%] -translate-x-[50%] translate-y-[50%]`,children:[(0,D.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[(0,D.jsx)(`h1`,{className:`text-center text-base sm:text-lg sm:my-4 text-foreground font-bold! text-[16px]`,children:e(`signup_threads`)}),(0,D.jsx)(O,{}),(0,D.jsx)(`div`,{className:`text-center`,children:(0,D.jsx)(w,{to:`/auth/forgot-password`,className:`text-sm text-foreground`,children:e(`forgot_psw`)})}),(0,D.jsxs)(`div`,{className:`relative my-6!`,children:[(0,D.jsx)(y,{className:`bg-normaltext!`}),(0,D.jsx)(`span`,{className:`absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 px-4 text-sm text-systemtext!`,children:e(`or`)})]})]}),(0,D.jsxs)(`p`,{className:`text-center`,children:[e(`havent_got_account`),(0,D.jsx)(w,{to:`/auth/login`,className:`text-foreground font-semibold hover:underline`,children:e(`login`)})]})]})}var A=k;export{A as default};