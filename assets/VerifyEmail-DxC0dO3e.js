import{$ as e,E as t,F as n,G as r,I as i,J as a,K as o,Q as s,U as c,X as l,Y as u,g as d}from"./index-CMrTxhGt.js";var f=e(s()),p=e(c()),m=()=>{let{t:e}=r(`VerifyEmail`),s=a(),c=l(),[m]=u(),h=m.get(`token`),[g,_]=(0,f.useState)(!0),[v,y]=(0,f.useState)(!1),[b,x]=(0,f.useState)(`verifying`),[S,C]=(0,f.useState)(``);(0,f.useEffect)(()=>{if(!h){x(`error`),C(e(`error.invalidToken`)),_(!1);return}(async()=>{try{let{user:r}=await n.verifyEmail(h)||{};r&&c(t(r)),x(`success`),C(e(`success.message`)),o(e(`success.title`)),setTimeout(()=>{window.close()},4e3)}catch(t){let n=t.response?.status;n===400||n===404||n===422?localStorage.getItem(`refreshToken`)?(x(`not-verified`),C(e(`notVerified.message`)),o.message?.(e(`notVerified.message`))||o(e(`notVerified.message`))):(x(`not-verified-no-auth`),C(e(`notVerified.needLoginMessage`)),o.message?.(e(`notVerified.needLoginMessage`))||o(e(`notVerified.needLoginMessage`))):(x(`error`),C(e(`error.verifyFailed`)),o.error(t.response?.data?.message||e(`error.verifyFailed`)))}finally{_(!1)}})()},[c,s,e,h]);let w=async()=>{y(!0);try{await n.resendVerificationEmail(),o.success(e(`notVerified.emailSent`)),C(e(`notVerified.checkInbox`))}catch(t){let n=t.response?.data?.message||e(`notVerified.resendFailed`);o.error(n)}finally{y(!1)}};return(0,p.jsxs)(p.Fragment,{children:[(b===`verifying`||g)&&(0,p.jsxs)(`div`,{className:`flex flex-col items-center`,children:[(0,p.jsx)(d,{className:`w-12 h-12`}),(0,p.jsx)(`p`,{className:`mt-4 text-lg text-foreground`,children:e(`verifying`)})]}),b===`not-verified`&&(0,p.jsxs)(`div`,{className:`flex flex-col items-center`,children:[(0,p.jsx)(`div`,{className:`text-6xl mb-4`,children:`ðŸ“§`}),(0,p.jsx)(`h1`,{className:`text-2xl font-bold text-foreground mb-2`,children:e(`notVerified.title`)}),(0,p.jsx)(`p`,{className:`text-muted-foreground mb-6 text-center`,children:S}),(0,p.jsx)(i,{onClick:w,disabled:v,className:`custom-button-style`,children:v?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d,{className:`mr-2`}),e(`notVerified.sending`)]}):e(`notVerified.resendButton`)})]}),b===`success`&&(0,p.jsxs)(`div`,{className:`flex flex-col items-center`,children:[(0,p.jsx)(`div`,{className:`text-6xl mb-4`,children:`âœ“`}),(0,p.jsx)(`h1`,{className:`text-2xl font-bold text-foreground mb-2`,children:e(`success.title`)}),(0,p.jsx)(`p`,{className:`text-muted-foreground mb-4`,children:S}),(0,p.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:e(`success.pleaseLogin`)})]}),b===`error`&&(0,p.jsxs)(`div`,{className:`flex flex-col items-center`,children:[(0,p.jsx)(`div`,{className:`text-6xl mb-4 text-red-500`,children:`âœ•`}),(0,p.jsx)(`h1`,{className:`text-2xl font-bold text-foreground mb-2`,children:e(`error.title`)}),(0,p.jsx)(`p`,{className:`text-muted-foreground mb-6`,children:S}),(0,p.jsx)(i,{onClick:w,disabled:v,className:`custom-button-style`,children:v?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d,{className:`mr-2`}),e(`notVerified.sending`)]}):e(`notVerified.resendButton`)})]})]})};export{m as default};