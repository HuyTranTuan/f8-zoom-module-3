import{$ as e,F as t,G as n,I as r,J as i,K as a,Q as o,U as s,X as c,Y as l,g as u,k as d}from"./index-D_Dprlbm.js";var f=e(o()),p=e(s()),m=()=>{let{t:e}=n(`VerifyEmail`),o=i(),s=c(),[m]=l(),h=m.get(`token`),[g,_]=(0,f.useState)(!0),[v,y]=(0,f.useState)(!1),[b,x]=(0,f.useState)(`verifying`),[S,C]=(0,f.useState)(``);(0,f.useEffect)(()=>{if(!h){x(`error`),C(e(`error.invalidToken`)),_(!1);return}(async()=>{try{let{user:n}=await t.verifyEmail(h)||{};n&&s(d(n)),x(`success`),C(e(`success.message`)),a(e(`success.title`)),setTimeout(()=>{window.close()},4e3)}catch(t){let n=t.response?.status;n===400||n===404||n===422?localStorage.getItem(`refreshToken`)?(x(`not-verified`),C(e(`notVerified.message`)),a.message?.(e(`notVerified.message`))||a(e(`notVerified.message`))):(x(`not-verified-no-auth`),C(e(`notVerified.needLoginMessage`)),a.message?.(e(`notVerified.needLoginMessage`))||a(e(`notVerified.needLoginMessage`))):(x(`error`),C(e(`error.verifyFailed`)),a.error(t.response?.data?.message||e(`error.verifyFailed`)))}finally{_(!1)}})()},[s,o,e,h]);let w=async()=>{y(!0);try{await t.resendVerificationEmail(),a.success(e(`notVerified.emailSent`)),C(e(`notVerified.checkInbox`))}catch(t){let n=t.response?.data?.message||e(`notVerified.resendFailed`);a.error(n)}finally{y(!1)}};return(0,p.jsxs)(p.Fragment,{children:[(b===`verifying`||g)&&(0,p.jsxs)(`div`,{className:`flex flex-col items-center`,children:[(0,p.jsx)(u,{className:`w-12 h-12`}),(0,p.jsx)(`p`,{className:`mt-4 text-lg text-foreground`,children:e(`verifying`)})]}),b===`not-verified`&&(0,p.jsxs)(`div`,{className:`flex flex-col items-center`,children:[(0,p.jsx)(`div`,{className:`text-6xl mb-4`,children:`ðŸ“§`}),(0,p.jsx)(`h1`,{className:`text-2xl font-bold text-foreground mb-2`,children:e(`notVerified.title`)}),(0,p.jsx)(`p`,{className:`text-muted-foreground mb-6 text-center`,children:S}),(0,p.jsx)(r,{onClick:w,disabled:v,className:`custom-button-style`,children:v?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(u,{className:`mr-2`}),e(`notVerified.sending`)]}):e(`notVerified.resendButton`)})]}),b===`success`&&(0,p.jsxs)(`div`,{className:`flex flex-col items-center`,children:[(0,p.jsx)(`div`,{className:`text-6xl mb-4`,children:`âœ“`}),(0,p.jsx)(`h1`,{className:`text-2xl font-bold text-foreground mb-2`,children:e(`success.title`)}),(0,p.jsx)(`p`,{className:`text-muted-foreground mb-4`,children:S}),(0,p.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:e(`success.pleaseLogin`)})]}),b===`error`&&(0,p.jsxs)(`div`,{className:`flex flex-col items-center`,children:[(0,p.jsx)(`div`,{className:`text-6xl mb-4 text-red-500`,children:`âœ•`}),(0,p.jsx)(`h1`,{className:`text-2xl font-bold text-foreground mb-2`,children:e(`error.title`)}),(0,p.jsx)(`p`,{className:`text-muted-foreground mb-6`,children:S}),(0,p.jsx)(r,{onClick:w,disabled:v,className:`custom-button-style`,children:v?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(u,{className:`mr-2`}),e(`notVerified.sending`)]}):e(`notVerified.resendButton`)})]})]})};export{m as default};